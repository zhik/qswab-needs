var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function r(e){e.forEach(t)}function o(e){return"function"==typeof e}function s(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function c(t,n,r){t.$$.on_destroy.push(function(t,...n){if(null==t)return e;const r=t.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function i(e,t){e.appendChild(t)}function l(e,t,n){e.insertBefore(t,n||null)}function a(e){e.parentNode.removeChild(e)}function u(e){return document.createElement(e)}function d(e){return document.createTextNode(e)}function f(){return d(" ")}function p(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}let m;function g(e){m=e}function h(e){(function(){if(!m)throw new Error("Function called outside component initialization");return m})().$$.on_mount.push(e)}const $=[],v=[],y=[],k=[],b=Promise.resolve();let x=!1;function w(e){y.push(e)}let _=!1;const C=new Set;function L(){if(!_){_=!0;do{for(let e=0;e<$.length;e+=1){const t=$[e];g(t),E(t.$$)}for($.length=0;v.length;)v.pop()();for(let e=0;e<y.length;e+=1){const t=y[e];C.has(t)||(C.add(t),t())}y.length=0}while($.length);for(;k.length;)k.pop()();x=!1,_=!1,C.clear()}}function E(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(w)}}const j=new Set;function M(e,t){e&&e.i&&(j.delete(e),e.i(t))}function T(e,n,s){const{fragment:c,on_mount:i,on_destroy:l,after_update:a}=e.$$;c&&c.m(n,s),w(()=>{const n=i.map(t).filter(o);l?l.push(...n):r(n),e.$$.on_mount=[]}),a.forEach(w)}function N(e,t){const n=e.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function P(e,t){-1===e.$$.dirty[0]&&($.push(e),x||(x=!0,b.then(L)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function I(t,o,s,c,i,l,u=[-1]){const d=m;g(t);const f=o.props||{},p=t.$$={fragment:null,ctx:null,props:l,update:e,not_equal:i,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:[]),callbacks:n(),dirty:u};let h=!1;if(p.ctx=s?s(t,f,(e,n,...r)=>{const o=r.length?r[0]:n;return p.ctx&&i(p.ctx[e],p.ctx[e]=o)&&(p.bound[e]&&p.bound[e](o),h&&P(t,e)),n}):[],p.update(),h=!0,r(p.before_update),p.fragment=!!c&&c(p.ctx),o.target){if(o.hydrate){const e=function(e){return Array.from(e.childNodes)}(o.target);p.fragment&&p.fragment.l(e),e.forEach(a)}else p.fragment&&p.fragment.c();o.intro&&M(t.$$.fragment),T(t,o.target,o.anchor),L()}g(d)}class O{$destroy(){N(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}const q=[];const R=function(t,n=e){let r;const o=[];function c(e){if(s(t,e)&&(t=e,r)){const e=!q.length;for(let e=0;e<o.length;e+=1){const n=o[e];n[1](),q.push(n,t)}if(e){for(let e=0;e<q.length;e+=2)q[e][0](q[e+1]);q.length=0}}}return{set:c,update:function(e){c(e(t))},subscribe:function(s,i=e){const l=[s,i];return o.push(l),1===o.length&&(r=n(c)||e),s(t),()=>{const e=o.indexOf(l);-1!==e&&o.splice(e,1),0===o.length&&(r(),r=null)}}}}(null);function S(e,t,n){const r=e.slice();return r[5]=t[n],r}function z(t){let n,r,o,s,c,m,g=t[5].letter+"",h=t[5].name+"";return{c(){var e,i,l,a;n=u("div"),r=u("div"),o=d(g),s=f(),c=u("div"),m=d(h),p(r,"class","marker marker-category svelte-rpt4k"),e=r,i="background-color",l=t[5].color,e.style.setProperty(i,l,a?"important":""),p(c,"class","label svelte-rpt4k"),p(n,"class","legend-item svelte-rpt4k")},m(e,t){l(e,n,t),i(n,r),i(r,o),i(n,s),i(n,c),i(c,m)},p:e,d(e){e&&a(n)}}}function H(t){let n,r,o,s,c,d,m,g,h,$,v,y,k,b,x,w,_,C,L=t[1],E=[];for(let e=0;e<L.length;e+=1)E[e]=z(S(t,L,e));return{c(){n=u("div"),r=u("div"),o=f(),s=u("div"),c=u("h4"),c.textContent="Queens DSNY Needs",d=f(),m=u("div"),m.innerHTML='<div class="marker marker-district svelte-rpt4k">1</div> \n            <div class="label svelte-rpt4k">District-wide need</div>',g=f(),h=u("div"),h.innerHTML='<div class="marker marker-location svelte-rpt4k">1</div> \n            <div class="label svelte-rpt4k">Location-specific need</div>',$=f(),v=u("span"),v.textContent="Lower numbers are higher priority",y=f(),k=u("hr"),b=f(),x=u("h5"),x.textContent="Categories",w=f();for(let e=0;e<E.length;e+=1)E[e].c();_=f(),C=u("span"),C.textContent="Click on points markers for more details",p(r,"id","map"),p(r,"class","svelte-rpt4k"),p(c,"class","svelte-rpt4k"),p(m,"class","legend-item svelte-rpt4k"),p(h,"class","legend-item svelte-rpt4k"),p(v,"class","subtitle svelte-rpt4k"),p(k,"class","svelte-rpt4k"),p(x,"class","svelte-rpt4k"),p(C,"class","subtitle svelte-rpt4k"),p(s,"class","legend svelte-rpt4k"),p(n,"class","map-view svelte-rpt4k")},m(e,a){l(e,n,a),i(n,r),t[4](r),i(n,o),i(n,s),i(s,c),i(s,d),i(s,m),i(s,g),i(s,h),i(s,$),i(s,v),i(s,y),i(s,k),i(s,b),i(s,x),i(s,w);for(let e=0;e<E.length;e+=1)E[e].m(s,null);i(s,_),i(s,C)},p(e,[t]){if(2&t){let n;for(L=e[1],n=0;n<L.length;n+=1){const r=S(e,L,n);E[n]?E[n].p(r,t):(E[n]=z(r),E[n].c(),E[n].m(s,_))}for(;n<E.length;n+=1)E[n].d(1);E.length=L.length}},i:e,o:e,d(e){e&&a(n),t[4](null),function(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}(E,e)}}}function A(e,t,n){let r,o,s;c(e,R,e=>n(3,r=e));const i=[{name:"Litter Basket Collection & Cleaning Service",color:"#aa5e58",letter:"L"},{name:"Infrastructure & Equipment",color:"#4060a3",letter:"I"},{name:"Residential Organics, Recycle, or Refuse",color:"#719a63",letter:"R",includes:"Residential"},{name:"Illegal Posting",color:"#846397",letter:"P"},{name:"Other",color:"#959595",letter:"O"}];return h(()=>{mapboxgl.accessToken="pk.eyJ1IjoiemhpayIsImEiOiJjaW1pbGFpdHQwMGNidnBrZzU5MjF5MTJiIn0.N-EURex2qvfEiBsm-W9j7w",n(2,s=new mapboxgl.Map({container:o,style:"mapbox://styles/zhik/cka343h1701vn1imnfp2nptkj",center:[-73.7717,40.67],zoom:10.45}))}),e.$$.update=()=>{if(8&e.$$.dirty&&r&&r.features){const e=r.features.reduce((e,t)=>{const n=t.properties.category;return e[n]=void 0===e[n]?1:e[n]+=1,e},{});console.log(e)}12&e.$$.dirty&&s&&r&&r.features&&s.on("load",()=>{s.addSource("needs",{type:"geojson",data:r}),s.addLayer({id:"needs-streets",type:"line",source:"needs",paint:{"line-color":"#363636","line-opacity":.8,"line-width":3},filter:["==","$type","LineString"]}),s.on("click","needs-streets",(function(e){const t=e.features[0],{type:n,request:r,explanation:o,tracking_code:c}=t.properties,i=c.slice(0,3);(new mapboxgl.Popup).setLngLat(e.lngLat).setHTML(`<h3>${r}</h3><p>${i}</p><p>${o}</p>`).addTo(s)})),s.on("mouseenter","needs-streets",(function(){s.getCanvas().style.cursor="pointer"})),s.on("mouseleave","needs-streets",(function(){s.getCanvas().style.cursor=""})),r.features.filter(e=>"Point"===e.geometry.type).forEach(e=>{const t=document.createElement("div"),{type:n,request:r,explanation:o,tracking_code:c,revised_priority:l,category:a}=e.properties,u=c.slice(0,3);t.className="marker marker-"+n,t.textContent=l,t.style.backgroundColor=(()=>{const e=i.find(e=>"includes"in e?a.includes(e.includes):e.name===a);return e?e.color:"#6a6a6a"})(),new mapboxgl.Marker(t).setLngLat(e.geometry.coordinates).setPopup(new mapboxgl.Popup({offset:5}).setHTML(`\n                                                    <h3>${r}</h3>\n                                                    <p><strong>${a}</strong></p>\n                                                    <p><strong>Community District:</strong> ${u}</p>\n                                                    <p>${o}</p>\n                                            `)).addTo(s)})})},[o,i,s,r,function(e){v[e?"unshift":"push"](()=>{n(0,o=e)})}]}class B extends O{constructor(e){super(),I(this,e,A,H,s,{})}}function D(t){let n,r;const o=new B({});return{c(){var e;n=u("main"),(e=o.$$.fragment)&&e.c(),p(n,"class","svelte-171nhqz")},m(e,t){l(e,n,t),T(o,n,null),r=!0},p:e,i(e){r||(M(o.$$.fragment,e),r=!0)},o(e){!function(e,t,n,r){if(e&&e.o){if(j.has(e))return;j.add(e),(void 0).c.push(()=>{j.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}}(o.$$.fragment,e),r=!1},d(e){e&&a(n),N(o)}}}function F(e){return h(()=>{(async()=>{const e=await(await fetch("data/needs.geojson")).json();R.set(e)})()}),[]}return new class extends O{constructor(e){super(),I(this,e,F,D,s,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
