var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function o(e){e.forEach(t)}function r(e){return"function"==typeof e}function s(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function c(t,n,o){t.$$.on_destroy.push(function(t,...n){if(null==t)return e;const o=t.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function i(e,t){e.appendChild(t)}function l(e,t,n){e.insertBefore(t,n||null)}function a(e){e.parentNode.removeChild(e)}function u(e){return document.createElement(e)}function d(e){return document.createTextNode(e)}function f(){return d(" ")}function p(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}let m;function g(e){m=e}function h(e){(function(){if(!m)throw new Error("Function called outside component initialization");return m})().$$.on_mount.push(e)}const $=[],v=[],y=[],b=[],x=Promise.resolve();let k=!1;function w(e){y.push(e)}let _=!1;const L=new Set;function C(){if(!_){_=!0;do{for(let e=0;e<$.length;e+=1){const t=$[e];g(t),E(t.$$)}for($.length=0;v.length;)v.pop()();for(let e=0;e<y.length;e+=1){const t=y[e];L.has(t)||(L.add(t),t())}y.length=0}while($.length);for(;b.length;)b.pop()();k=!1,_=!1,L.clear()}}function E(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(w)}}const j=new Set;function M(e,t){e&&e.i&&(j.delete(e),e.i(t))}function T(e,n,s){const{fragment:c,on_mount:i,on_destroy:l,after_update:a}=e.$$;c&&c.m(n,s),w(()=>{const n=i.map(t).filter(r);l?l.push(...n):o(n),e.$$.on_mount=[]}),a.forEach(w)}function N(e,t){const n=e.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function P(e,t){-1===e.$$.dirty[0]&&($.push(e),k||(k=!0,x.then(C)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function I(t,r,s,c,i,l,u=[-1]){const d=m;g(t);const f=r.props||{},p=t.$$={fragment:null,ctx:null,props:l,update:e,not_equal:i,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:[]),callbacks:n(),dirty:u};let h=!1;if(p.ctx=s?s(t,f,(e,n,...o)=>{const r=o.length?o[0]:n;return p.ctx&&i(p.ctx[e],p.ctx[e]=r)&&(p.bound[e]&&p.bound[e](r),h&&P(t,e)),n}):[],p.update(),h=!0,o(p.before_update),p.fragment=!!c&&c(p.ctx),r.target){if(r.hydrate){const e=function(e){return Array.from(e.childNodes)}(r.target);p.fragment&&p.fragment.l(e),e.forEach(a)}else p.fragment&&p.fragment.c();r.intro&&M(t.$$.fragment),T(t,r.target,r.anchor),C()}g(d)}class O{$destroy(){N(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}const q=[];const R=function(t,n=e){let o;const r=[];function c(e){if(s(t,e)&&(t=e,o)){const e=!q.length;for(let e=0;e<r.length;e+=1){const n=r[e];n[1](),q.push(n,t)}if(e){for(let e=0;e<q.length;e+=2)q[e][0](q[e+1]);q.length=0}}}return{set:c,update:function(e){c(e(t))},subscribe:function(s,i=e){const l=[s,i];return r.push(l),1===r.length&&(o=n(c)||e),s(t),()=>{const e=r.indexOf(l);-1!==e&&r.splice(e,1),0===r.length&&(o(),o=null)}}}}(null);function S(e,t,n){const o=e.slice();return o[5]=t[n],o}function z(t){let n,o,r,s,c,m,g,h=t[5].letter+"",$=t[5].name+"";return{c(){var e,i,l,a;n=u("div"),o=u("div"),r=d(h),s=f(),c=u("div"),m=d($),g=f(),p(o,"class","marker marker-category svelte-194rpos"),e=o,i="background-color",l=t[5].color,e.style.setProperty(i,l,a?"important":""),p(c,"class","label svelte-194rpos"),p(n,"class","legend-item svelte-194rpos")},m(e,t){l(e,n,t),i(n,o),i(o,r),i(n,s),i(n,c),i(c,m),i(n,g)},p:e,d(e){e&&a(n)}}}function H(t){let n,o,r,s,c,d,m,g,h,$,v,y,b,x,k=t[1],w=[];for(let e=0;e<k.length;e+=1)w[e]=z(S(t,k,e));return{c(){n=u("div"),o=u("div"),r=f(),s=u("div"),c=u("h4"),c.textContent="Queens DSNY Needs",d=f(),m=u("div"),m.innerHTML='<div class="marker marker-district svelte-194rpos">1</div> \n            <div class="label svelte-194rpos">District-wide need</div>',g=f(),h=u("div"),h.innerHTML='<div class="marker marker-location svelte-194rpos">1</div> \n            <div class="label svelte-194rpos">Location-specific need</div>',$=f(),v=u("hr"),y=f(),b=u("h5"),b.textContent="Categories",x=f();for(let e=0;e<w.length;e+=1)w[e].c();p(o,"id","map"),p(o,"class","svelte-194rpos"),p(c,"class","svelte-194rpos"),p(m,"class","legend-item svelte-194rpos"),p(h,"class","legend-item svelte-194rpos"),p(v,"class","svelte-194rpos"),p(b,"class","svelte-194rpos"),p(s,"class","legend svelte-194rpos"),p(n,"class","map-view svelte-194rpos")},m(e,a){l(e,n,a),i(n,o),t[4](o),i(n,r),i(n,s),i(s,c),i(s,d),i(s,m),i(s,g),i(s,h),i(s,$),i(s,v),i(s,y),i(s,b),i(s,x);for(let e=0;e<w.length;e+=1)w[e].m(s,null)},p(e,[t]){if(2&t){let n;for(k=e[1],n=0;n<k.length;n+=1){const o=S(e,k,n);w[n]?w[n].p(o,t):(w[n]=z(o),w[n].c(),w[n].m(s,null))}for(;n<w.length;n+=1)w[n].d(1);w.length=k.length}},i:e,o:e,d(e){e&&a(n),t[4](null),function(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}(w,e)}}}function A(e,t,n){let o,r,s;c(e,R,e=>n(3,o=e));const i=[{name:"Litter Basket Collection & Cleaning Service",color:"#aa5e58",letter:"L"},{name:"Infrastructure & Equipment",color:"#617fa1",letter:"I"},{name:"Residential Organics, Recycle, or Refuse",color:"#719a63",letter:"R",includes:"Residential"},{name:"Illegal Posting",color:"#846397",letter:"P"},{name:"Other",color:"#6a6a6a",letter:"O"}];return h(()=>{mapboxgl.accessToken="pk.eyJ1IjoiemhpayIsImEiOiJjaW1pbGFpdHQwMGNidnBrZzU5MjF5MTJiIn0.N-EURex2qvfEiBsm-W9j7w",n(2,s=new mapboxgl.Map({container:r,style:"mapbox://styles/zhik/cka343h1701vn1imnfp2nptkj",center:[-73.7717,40.67],zoom:10.45}))}),e.$$.update=()=>{if(8&e.$$.dirty&&o&&o.features){const e=o.features.reduce((e,t)=>{const n=t.properties.category;return e[n]=void 0===e[n]?1:e[n]+=1,e},{});console.log(e)}12&e.$$.dirty&&s&&o&&o.features&&s.on("load",()=>{s.addSource("needs",{type:"geojson",data:o}),s.addLayer({id:"needs-streets",type:"line",source:"needs",paint:{"line-color":"#363636","line-opacity":.8,"line-width":3},filter:["==","$type","LineString"]}),s.on("click","needs-streets",(function(e){const t=e.features[0],{type:n,request:o,explanation:r,tracking_code:c}=t.properties,i=c.slice(0,3);(new mapboxgl.Popup).setLngLat(e.lngLat).setHTML(`<h3>${o}</h3><p>${i}</p><p>${r}</p>`).addTo(s)})),s.on("mouseenter","needs-streets",(function(){s.getCanvas().style.cursor="pointer"})),s.on("mouseleave","needs-streets",(function(){s.getCanvas().style.cursor=""})),o.features.filter(e=>"Point"===e.geometry.type).forEach(e=>{const t=document.createElement("div"),{type:n,request:o,explanation:r,tracking_code:c,revised_priority:l,category:a}=e.properties,u=c.slice(0,3);t.className="marker marker-"+n,t.textContent=l,t.style.backgroundColor=(()=>{const e=i.find(e=>"includes"in e?a.includes(e.includes):e.name===a);return e?e.color:"#6a6a6a"})(),new mapboxgl.Marker(t).setLngLat(e.geometry.coordinates).setPopup(new mapboxgl.Popup({offset:5}).setHTML(`\n                                                    <h3>${o}</h3>\n                                                    <p>${a}</p>\n                                                    <p>Community District: ${u}</p>\n                                                    <p>${r}</p>\n                                            `)).addTo(s)})})},[r,i,s,o,function(e){v[e?"unshift":"push"](()=>{n(0,r=e)})}]}class B extends O{constructor(e){super(),I(this,e,A,H,s,{})}}function D(t){let n,o;const r=new B({});return{c(){var e;n=u("main"),(e=r.$$.fragment)&&e.c(),p(n,"class","svelte-171nhqz")},m(e,t){l(e,n,t),T(r,n,null),o=!0},p:e,i(e){o||(M(r.$$.fragment,e),o=!0)},o(e){!function(e,t,n,o){if(e&&e.o){if(j.has(e))return;j.add(e),(void 0).c.push(()=>{j.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}}(r.$$.fragment,e),o=!1},d(e){e&&a(n),N(r)}}}function F(e){return h(()=>{(async()=>{const e=await(await fetch("data/needs.geojson")).json();R.set(e)})()}),[]}return new class extends O{constructor(e){super(),I(this,e,F,D,s,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
