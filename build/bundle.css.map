{
  "version": 3,
  "file": "bundle.css",
  "sources": [
    "../../App.svelte",
    "../../MapView.svelte"
  ],
  "sourcesContent": [
    "<script>\n    import {onMount} from 'svelte'\n    import {needsData} from './stores'\n    import MapView from './components/MapView.svelte'\n\n    onMount(() => {\n        (async () => {\n            // Load data from needs.geojson\n            const features = await (await fetch('data/needs.geojson')).json()\n            needsData.set(features)\n        })();\n    })\n</script>\n\n<main>\n    <MapView/>\n</main>\n\n<style>\n    main {\n        padding: 1em 0.5em;\n        margin: 0 auto;\n    }\n\n    @media (max-width: 768px) {\n        main {\n            padding: 1em 2em;\n        }\n    }\n</style>",
    "<script>\n    import {onMount} from 'svelte'\n    import {needsData} from '../stores'\n\n    let container;\n    let map\n\n    const categories = [\n        {name: 'Litter Basket Collection & Cleaning Service', color: '#aa5e58', letter: 'L'},\n        {name: 'Infrastructure & Equipment', color: '#617fa1', letter: 'I'},\n        {name: 'Residential Organics, Recycle, or Refuse', color: '#719a63', letter: 'R', includes: 'Residential'},\n        {name: 'Illegal Posting', color: '#846397', letter: 'P'},\n        {name: 'Other', color: '#6a6a6a', letter: 'O'}\n    ]\n\n    onMount(() => {\n        mapboxgl.accessToken = 'pk.eyJ1IjoiemhpayIsImEiOiJjaW1pbGFpdHQwMGNidnBrZzU5MjF5MTJiIn0.N-EURex2qvfEiBsm-W9j7w';\n        map = new mapboxgl.Map({\n            container,\n            style: 'mapbox://styles/zhik/cka343h1701vn1imnfp2nptkj',\n            center: [-73.7717, 40.67],\n            zoom: 10.45\n\n        });\n    })\n\n    $: {\n        if ($needsData && $needsData.features) {\n            const cats = $needsData.features.reduce((a, f) => {\n                const category = f.properties.category\n                a[category] = a[category] === undefined ? 1 : a[category] += 1\n                return a\n            }, {})\n            console.log(cats)\n        }\n    }\n\n\n    $: {\n        if (map && $needsData && $needsData.features) {\n            map.on('load', () => {\n                map.addSource('needs', {'type': 'geojson', data: $needsData});\n\n                map.addLayer({\n                    'id': 'needs-streets',\n                    'type': 'line',\n                    'source': 'needs',\n                    'paint': {\n                        'line-color': '#363636',\n                        'line-opacity': 0.8,\n                        'line-width': 3\n                    },\n                    'filter': ['==', '$type', 'LineString']\n                });\n\n                map.on('click', 'needs-streets', function (e) {\n                    const feature = e.features[0]\n                    const {type, request, explanation, tracking_code} = feature.properties\n                    const district = tracking_code.slice(0, 3)\n\n                    new mapboxgl.Popup()\n                            .setLngLat(e.lngLat)\n                            .setHTML(`<h3>${request}</h3><p>${district}</p><p>${explanation}</p>`)\n                            .addTo(map);\n                });\n\n                map.on('mouseenter', 'needs-streets', function () {\n                    map.getCanvas().style.cursor = 'pointer';\n                });\n\n                map.on('mouseleave', 'needs-streets', function () {\n                    map.getCanvas().style.cursor = '';\n                });\n\n                //for each point feature add html marker\n                $needsData.features\n                        .filter(feature => feature.geometry.type === 'Point')\n                        .forEach(feature => {\n                            // create a HTML element for each feature\n                            const el = document.createElement('div');\n                            const {type, request, explanation, tracking_code, revised_priority, category} = feature.properties\n                            const district = tracking_code.slice(0, 3)\n                            el.className = `marker marker-${type}`;\n                            el.textContent = revised_priority\n                            el.style.backgroundColor = (() => {\n                                const found = categories.find((cat) => {\n                                    if('includes' in cat){\n                                        return category.includes(cat.includes)\n                                    }else{\n                                        return cat.name === category\n                                    }\n                                })\n                                return found ? found.color : '#6a6a6a'\n                            })()\n\n                            // make a marker for each feature and add to the map\n                            new mapboxgl.Marker(el)\n                                    .setLngLat(feature.geometry.coordinates)\n                                    .setPopup(new mapboxgl.Popup({offset: 5})\n                                            .setHTML(`\n                                                    <h3>${request}</h3>\n                                                    <p>${category}</p>\n                                                    <p>Community District: ${district}</p>\n                                                    <p>${explanation}</p>\n                                            `))\n                                    .addTo(map);\n                        })\n            });\n        }\n    }\n\n</script>\n\n<div class=\"map-view\">\n    <div id=\"map\" bind:this={container}></div>\n    <div class=\"legend\">\n        <h4>Queens DSNY Needs</h4>\n        <div class=\"legend-item\">\n            <div class=\"marker marker-district\">1</div>\n            <div class=\"label\">District-wide need</div>\n        </div>\n        <div class=\"legend-item\">\n            <div class=\"marker marker-location\">1</div>\n            <div class=\"label\">Location-specific need</div>\n        </div>\n        <hr/>\n        <h5>Categories</h5>\n        {#each categories as cat}\n            <div class=\"legend-item\">\n                <div class=\"marker marker-category\" style=\"background-color: {cat.color}\">{cat.letter}</div>\n                <div class=\"label\">{cat.name}</div>\n            </div>\n        {/each}\n    </div>\n</div>\n\n<style>\n    .map-view {\n        position: relative;\n    }\n\n    #map {\n        width: 100%;\n        height: 700px;\n    }\n\n    .legend {\n        line-height: 18px;\n        color: #555;\n        position: absolute;\n        bottom: 40px;\n        right: 0px;\n        z-index: 2;\n        background-color: rgba(255, 255, 255, 0.7);\n        padding: 5px 10px;\n    }\n\n    .legend h4, h5 {\n        margin: 5px 0px;\n    }\n\n    .legend hr {\n        background-color: #8b8b8b;\n        margin: 4px 0px;\n    }\n\n    .legend-item {\n        letter-spacing: -1px;\n        margin-right: 1rem;\n        display: flex;\n        flex-direction: row;\n    }\n\n    .legend-item .marker {\n        padding-right: 1px;\n        padding-bottom: 1px;\n        cursor: default;\n    }\n\n    .label {\n        margin-left: 1rem;\n    }\n\n    :global(.marker) {\n        text-align: center;\n        background-color: #363636;\n        color: white;\n        font-weight: 600;\n        line-height: 14.5px;\n        height: 14px;\n        width: 14px;\n        font-size: 10px;\n        border: 1px solid rgba(255, 255, 255, 0.6);\n        cursor: pointer;\n    }\n\n    :global(.marker-category) {\n        background-color: #9e9e9e;\n    }\n\n    :global(.marker-district) {\n        border-radius: 50%;\n\n    }\n\n    :global(.marker-location) {\n        border-radius: 1px;\n    }\n\n    :global(.mapboxgl-popup) {\n        max-width: 300px;\n    }\n\n    :global(.mapboxgl-popup-content) {\n        font-family: 'Open Sans', sans-serif;\n        max-height: 300px;\n        overflow-y: auto;\n        padding: 5px 10px !important;\n    }\n\n    :global(.mapboxgl-popup-content *) {\n        margin: 4px;\n    }\n\n</style>"
  ],
  "names": [],
  "mappings": "AAmBI,IAAI,eAAC,CAAC,AACF,OAAO,CAAE,GAAG,CAAC,KAAK,CAClB,MAAM,CAAE,CAAC,CAAC,IAAI,AAClB,CAAC,AAED,MAAM,AAAC,YAAY,KAAK,CAAC,AAAC,CAAC,AACvB,IAAI,eAAC,CAAC,AACF,OAAO,CAAE,GAAG,CAAC,GAAG,AACpB,CAAC,AACL,CAAC;AC6GD,SAAS,8BAAC,CAAC,AACP,QAAQ,CAAE,QAAQ,AACtB,CAAC,AAED,IAAI,8BAAC,CAAC,AACF,KAAK,CAAE,IAAI,CACX,MAAM,CAAE,KAAK,AACjB,CAAC,AAED,OAAO,8BAAC,CAAC,AACL,WAAW,CAAE,IAAI,CACjB,KAAK,CAAE,IAAI,CACX,QAAQ,CAAE,QAAQ,CAClB,MAAM,CAAE,IAAI,CACZ,KAAK,CAAE,GAAG,CACV,OAAO,CAAE,CAAC,CACV,gBAAgB,CAAE,KAAK,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAC1C,OAAO,CAAE,GAAG,CAAC,IAAI,AACrB,CAAC,AAED,sBAAO,CAAC,iBAAE,CAAE,EAAE,8BAAC,CAAC,AACZ,MAAM,CAAE,GAAG,CAAC,GAAG,AACnB,CAAC,AAED,sBAAO,CAAC,EAAE,eAAC,CAAC,AACR,gBAAgB,CAAE,OAAO,CACzB,MAAM,CAAE,GAAG,CAAC,GAAG,AACnB,CAAC,AAED,YAAY,8BAAC,CAAC,AACV,cAAc,CAAE,IAAI,CACpB,YAAY,CAAE,IAAI,CAClB,OAAO,CAAE,IAAI,CACb,cAAc,CAAE,GAAG,AACvB,CAAC,AAED,2BAAY,CAAC,OAAO,eAAC,CAAC,AAClB,aAAa,CAAE,GAAG,CAClB,cAAc,CAAE,GAAG,CACnB,MAAM,CAAE,OAAO,AACnB,CAAC,AAED,MAAM,8BAAC,CAAC,AACJ,WAAW,CAAE,IAAI,AACrB,CAAC,AAEO,OAAO,AAAE,CAAC,AACd,UAAU,CAAE,MAAM,CAClB,gBAAgB,CAAE,OAAO,CACzB,KAAK,CAAE,KAAK,CACZ,WAAW,CAAE,GAAG,CAChB,WAAW,CAAE,MAAM,CACnB,MAAM,CAAE,IAAI,CACZ,KAAK,CAAE,IAAI,CACX,SAAS,CAAE,IAAI,CACf,MAAM,CAAE,GAAG,CAAC,KAAK,CAAC,KAAK,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAC1C,MAAM,CAAE,OAAO,AACnB,CAAC,AAEO,gBAAgB,AAAE,CAAC,AACvB,gBAAgB,CAAE,OAAO,AAC7B,CAAC,AAEO,gBAAgB,AAAE,CAAC,AACvB,aAAa,CAAE,GAAG,AAEtB,CAAC,AAEO,gBAAgB,AAAE,CAAC,AACvB,aAAa,CAAE,GAAG,AACtB,CAAC,AAEO,eAAe,AAAE,CAAC,AACtB,SAAS,CAAE,KAAK,AACpB,CAAC,AAEO,uBAAuB,AAAE,CAAC,AAC9B,WAAW,CAAE,WAAW,CAAC,CAAC,UAAU,CACpC,UAAU,CAAE,KAAK,CACjB,UAAU,CAAE,IAAI,CAChB,OAAO,CAAE,GAAG,CAAC,IAAI,CAAC,UAAU,AAChC,CAAC,AAEO,yBAAyB,AAAE,CAAC,AAChC,MAAM,CAAE,GAAG,AACf,CAAC"
}